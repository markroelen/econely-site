<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8">
  <title>Econely Bestellen</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 20px;
      color: #314528;
      background-color: #f9f9f9;
    }

    h1, h2 {
      font-size: 1.6em;
      margin-bottom: 20px;
      color: #314528;
    }

    details {
      margin-bottom: 20px;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
      background-color: #ffffff;
      transition: all 0.3s ease;
    }

    summary {
      font-size: 1.2em;
      font-weight: 600;
      padding: 15px 20px;
      background-color: #dfdfdf;
      color: #314528;
      cursor: pointer;
      user-select: none;
    }

    summary::marker {
      display: none;
    }

    .product {
      display: flex;
      flex-direction: row;
      background: #fff;
      padding: 15px 20px;
      border-top: 1px solid #eee;
      align-items: center;
      gap: 15px;
      flex-wrap: wrap;
      cursor: pointer;
    }

    .product:hover {
      background-color: #f0f0f0;
    }

    .product input[type="checkbox"] {
      pointer-events: none;
    }

    .product img {
      width: 120px;
      height: auto;
      border-radius: 8px;
    }

    .product h4 {
      font-size: 1.1em;
      margin: 0 0 5px 0;
      color: #333;
    }

    .product p {
      font-size: 1em;
      color: #666;
      margin-bottom: 10px;
    }

    .totaal {
      font-size: 1.4em;
      font-weight: bold;
      color: #b2935b;
      margin: 25px 0 15px 0;
      text-align: center;
    }

    form {
      background-color: #fff;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.06);
      margin-bottom: 30px;
      max-width: 600px;
      margin-left: auto;
      margin-right: auto;
    }

    label {
      font-size: 1em;
      display: block;
      margin-bottom: 15px;
      color: #333;
    }

    input[type=text], input[type=email] {
      padding: 14px;
      width: 100%;
      box-sizing: border-box;
      border: 1px solid #ccc;
      border-radius: 8px;
      margin-top: 5px;
      font-size: 1em;
    }

    button {
      width: 100%;
      padding: 15px;
      font-size: 1.1em;
      background-color: #314528;
      color: white;
      border: none;
      border-radius: 8px;
      margin-top: 20px;
      cursor: pointer;
      transition: background 0.3s ease;
    }

    button:hover {
      background-color: #3f5c36;
    }

    #stap2 {
      margin-top: 40px;
      max-width: 600px;
      margin-left: auto;
      margin-right: auto;
    }

    .button-link {
      background-color: #0072b1;
      display: block;
      width: 100%;
      padding: 15px;
      text-align: center;
      color: white;
      text-decoration: none;
      border-radius: 8px;
      font-size: 1.1em;
      margin-top: 15px;
    }

    .button-link:hover {
      background-color: #005c91;
    }
  </style>
</head>
<body>
<h1>Stap 1: Bekijk en stel je Econely keuken samen</h1>

<details open><summary>Alle producten</summary>

    <div class="product">
      <input type="checkbox" class="product-checkbox" data-price="3.87" data-name="Bakpapier - 15m - navulling">
      <img src="https://cdn.eco-logisch.nl/images/bakpapier_navul.jpg" alt="Bakpapier - 15m - navulling">
      <div>
          <h4>Bakpapier - 15m - navulling</h4>
          <p><strong>€ 3.87</strong></p>
      </div>
    </div>

    <div class="product">
      <input type="checkbox" class="product-checkbox" data-price="5.20" data-name="Bakpapier - 15m - incl. dispenser">
      <img src="https://cdn.eco-logisch.nl/images/bakpapier_doos.jpg" alt="Bakpapier - 15m - incl. dispenser">
      <div>
          <h4>Bakpapier - 15m - incl. dispenser</h4>
          <p><strong>€ 5.20</strong></p>
      </div>
    </div>

    <div class="product">
      <input type="checkbox" class="product-checkbox" data-price="3.63" data-name="Citrus Pers FSC Hout">
      <img src="https://cdn.eco-logisch.nl/images/citrus-pers.jpg" alt="Citrus Pers FSC Hout">
      <div>
          <h4>Citrus Pers FSC Hout</h4>
          <p><strong>€ 3.63</strong></p>
      </div>
    </div>

</details>

<div class="totaal">Totale prijs: €<span id="totaalbedrag">6.95</span></div>

<form id="bestelform">
  <input type="hidden" name="_subject" value="Nieuwe bestelling via Econely">
  <input type="hidden" name="producten" id="productenInput">
  <input type="hidden" name="totaal" id="totaalInput">

  <label>Naam:<br><input type="text" name="naam" id="klantNaam" required></label>
  <label>Emailadres:<br><input type="email" name="email" id="klantEmail" required></label>
  <label>Straat + huisnummer:<br><input type="text" name="adres" required></label>
  <label>Plaats:<br><input type="text" name="plaats" required></label>

  <button type="submit">Verstuur formulier</button>
</form>

<div id="stap2">
  <h2>Stap 2: Betaal je bestelling via Rabobank</h2>
  <p>
    Nadat je het formulier hierboven hebt ingevuld en verstuurd, betaal je via de onderstaande Rabobank-betaallink.
    <br><strong>Onthoud het totaalbedrag hierboven</strong> en vul dat handmatig in op de volgende pagina.
  </p>
  <a class="button-link" href="https://betaalverzoek.rabobank.nl/betaalverzoek/?id=BJrL5SCVSL-xpRA6BtgHoA" target="_blank">Betaal nu via Rabobank</a>
</div>

<script>
  const totaalbedrag = document.getElementById('totaalbedrag');
  const form = document.getElementById('bestelform');
  const productenInput = document.getElementById('productenInput');
  const totaalInput = document.getElementById('totaalInput');
  const vasteKosten = 6.95;

  function getBesteldeProducten() {
    let producten = [];
    document.querySelectorAll('.product-checkbox').forEach(cb => {
      if (cb.checked) {
        producten.push(cb.dataset.name);
      }
    });
    return producten.join(', ');
  }

  function getTotaal() {
    let totaal = vasteKosten;
    document.querySelectorAll('.product-checkbox').forEach(cb => {
      if (cb.checked) {
        const prijs = parseFloat(cb.getAttribute('data-price'));
        if (!isNaN(prijs)) totaal += prijs;
      }
    });
    return totaal.toFixed(2);
  }

  function updateTotaal() {
    totaalbedrag.textContent = getTotaal();
  }

  document.addEventListener('change', (e) => {
    if (e.target.classList.contains('product-checkbox')) {
      updateTotaal();
    }
  });

  document.querySelectorAll('.product').forEach(div => {
    div.addEventListener('click', function (e) {
      const checkbox = this.querySelector('input[type="checkbox"]');
      if (checkbox && e.target !== checkbox) {
        checkbox.checked = !checkbox.checked;
        checkbox.dispatchEvent(new Event('change'));
      }
    });
  });

  form.addEventListener('submit', async function(e) {
    e.preventDefault();

    const producten = getBesteldeProducten();
    const totaal = getTotaal();

    if (!producten || parseFloat(totaal) <= vasteKosten) {
      alert("Kies minstens één product.");
      return;
    }

    productenInput.value = producten;
    totaalInput.value = totaal;

    const formData = new FormData(form);

    try {
      const response = await fetch("https://formspree.io/f/xnnpdqbq", {
        method: "POST",
        body: formData,
        headers: { 'Accept': 'application/json' }
      });

      if (response.ok) {
        alert("Je bestelling is verzonden. Je kunt nu betalen via stap 2 hieronder.");
        form.reset();
        updateTotaal();
      } else {
        alert("Er ging iets mis. Probeer het opnieuw.");
      }
    } catch (error) {
      alert("Fout bij verzenden: " + error.message);
    }
  });
</script>
</body>
</html>
